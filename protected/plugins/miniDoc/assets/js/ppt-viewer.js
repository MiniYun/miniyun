var $id=function(a){return document.getElementById(a)};var $create=function(a){return document.createElement(a)};var $class=function(e,d){if(document.getElementsByClassName){return document.getElementsByClassName(e)}else{var a=document.getElementsByTagName(d),b=[];for(var c=0;c<a.length;c++){if(hasClass(a[c],e)){b.push(a[c])}}return b}};function hasClass(d,c){var a=d.className.split(/\s+/);for(var b=0;b<a.length;b++){if(a[b]==c){return true}}return false}function getURLParameter(a){return decodeURI((RegExp(a+"=(.+?)(&|$)").exec(location.search)||[,null])[1])}var sys={};var ua=navigator.userAgent.toLowerCase();var s;(s=ua.match(/msie ([\d.]+)/))?sys.ie=s[1]:(s=ua.match(/firefox\/([\d.]+)/))?sys.firefox=s[1]:(s=ua.match(/chrome\/([\d.]+)/))?sys.chrome=s[1]:(s=ua.match(/opera.([\d.]+)/))?sys.opera=s[1]:(s=ua.match(/version\/([\d.]+).*safari/))?sys.safari=s[1]:0;var leftImageLoading=function(){var d;for(d=0;d<imageList.length;d++){var a=$id("left-image-box");var c=$create("div");var e=$create("span");var b=$create("img");c.setAttribute("class","self-imgbox");b.setAttribute("class","thumbnail");b.setAttribute("src",imageList[d]);e.textContent=d+1;a.appendChild(c);c.appendChild(e);c.appendChild(b)}};var rightImageLoading=function(){var e;var b=$id("right-image-box");var c=$create("table");var g=$create("div");var a=$create("div");var f=$create("tr");var d=$create("td");imgObj=$create("img");imgObj.setAttribute("src",imageList[0]);imgObj.setAttribute("id","right-image-show");imgObj.setAttribute("style","height");imgObj.setAttribute("style","width");c.setAttribute("id","right-table");g.setAttribute("id","parent-div");a.setAttribute("id","right-panel");a.setAttribute("style","height");a.setAttribute("style","width");b.appendChild(c);c.appendChild(f);f.appendChild(d);d.appendChild(imgObj);b.appendChild(g);g.appendChild(a);sImgBox=$class("self-imgbox","div");sImgBox[0].className="self-imgbox selected";for(e=0;e<imageList.length;e++){(function(h){sImgBox[h].onclick=function(){for(var i=0;i<sImgBox.length;i++){sImgBox[i].className="self-imgbox";imgObj.setAttribute("src",imageList[h])}sImgBox[h].className="self-imgbox selected"}})(e)}};var toolBarLoading=function(){var f=document.getElementsByTagName("body");var e=$create("div");var d=$create("a");var g=$create("span");var b=$create("span");var c=$create("a");var h=$create("span");var a=$create("span");e.setAttribute("id","head");e.setAttribute("class","head-bar");d.setAttribute("class","play");g.setAttribute("class","icon");b.setAttribute("class","label");c.setAttribute("class","playcur");h.setAttribute("class","icon");a.setAttribute("class","label");f[0].appendChild(e);e.appendChild(d);d.appendChild(g);d.appendChild(b);e.appendChild(c);c.appendChild(h);c.appendChild(a)};var showTopBar=function(){var a=$id("head");var b=1;var e=null;var c=30;a.onmouseover=function(){d(70)};a.onmouseout=function(){d(0)};function d(f){clearInterval(e);e=setInterval(function(){if(f>c){b=5}else{b=-5}if(c==f){clearInterval(e)}else{c=c+b;a.style.filter="alpha(opacity="+c+")";a.style.opacity=c/100}},5)}};var headBarLoading=function(){var b=0;var a=document.getElementsByTagName("body");bacDivObj=$create("div");bacImgObj=$create("img");bacImgObj.setAttribute("src",imageList[b]);bacDivObj.setAttribute("style","color");bacDivObj.setAttribute("style","height");bacDivObj.setAttribute("style","width");bacDivObj.setAttribute("id","popup-background");bacImgObj.setAttribute("id","popup-image");a[0].appendChild(bacDivObj);bacDivObj.appendChild(bacImgObj);bacDivObj.style.position="absolute";bacDivObj.style.top="0";bacDivObj.style.left="0";bacDivObj.style.backgroundColor="#000000";bacDivObj.style.zIndex=201;bacDivObj.style.display="none";bacDivObj.style.overflow="hidden";bacDivObj.style.height=document.documentElement.clientHeight+"px";bacDivObj.style.width=document.documentElement.clientWidth+"px";bacImgObj.style.height="100%";bacImgObj.style.width="80%"};var viewFirstPPT=function(){bacImgObj.setAttribute("src",imageList[0]);var b=0;var a=$class("play","a");a[0].onclick=function(){bacDivObj.style.display="block";bacDivObj.onclick=function(){if(b<imageList.length){bacImgObj.setAttribute("src",imageList[b]);b++}else{bacDivObj.style.display="none"}};document.onkeydown=function(d){var f=d||event;var c=f.keyCode||f.which||f.charCode;if(b<=imageList.length&&b>=0){if(c==37||c==38){b--;if(b<0){b=0}bacImgObj.setAttribute("src",imageList[b])}else{if(c==39||c==40){b++;if(b>=imageList.length){b=imageList.length-1}bacImgObj.setAttribute("src",imageList[b])}else{if(c==27){bacDivObj.style.display="none"}}}}else{bacDivObj.style.display="none"}};return b=0}};var viewThisPPT=function(){var a=$class("playcur","a");a[0].onclick=function(){var c;for(var b=0;b<imageList.length;b++){if(sImgBox[b].className=="self-imgbox selected"){bacImgObj.setAttribute("src",imageList[b]);c=b}}bacDivObj.style.display="block";bacDivObj.onclick=function(){if(c<imageList.length){bacImgObj.setAttribute("src",imageList[c]);c++}else{bacDivObj.style.display="none"}};document.onkeydown=function(f){var g=f||event;var d=g.keyCode||g.which||g.charCode;if(c<=imageList.length&&c>=0){if(d==37||d==38){c--;if(c<0){c=0}bacImgObj.setAttribute("src",imageList[c])}else{if(d==39||d==40){c++;if(c>=imageList.length){c=imageList.length-1}bacImgObj.setAttribute("src",imageList[c])}else{if(d==27){bacDivObj.style.display="none"}}}}else{bacDivObj.style.display="none"}}}};var useMouseWheel=function(){function g(h){h=h||event;return(h.wheelDelta?h.wheelDelta/120:-(h.detail%3==0?h.detail/3:h.detail))}function e(h){h=h||event;if(h.preventDefault){h.preventDefault()}h.returnValue=false}function f(j,i,h){var k=typeof document.body.style.MozUserSelect!="undefined";if(j.addEventListener){j.addEventListener(k?"DOMMouseScroll":i,h,false)}else{j.attachEvent("on"+i,h)}return h}function d(j,i,h){var k=typeof document.body.style.MozUserSelect!="undefined";if(j.removeEventListener){j.removeEventListener(k?"DOMMouseScroll":i,h,false)}else{j.detachEvent("on"+i,h)}}function b(i,h,j){return Math.min(h,Math.max(i,j))}var a=$id("right-image-box");var c=0;f(a,"mousewheel",function(m){e(m);var n=g(m);a.scrollTop=b(a.scrollTop-(n*(document.documentElement.clientHeight)),26118,0);var h=$id("left-image-box");if(m.wheelDelta){if(m.wheelDelta>0){c=c-1;if(c<0){c=0}imgObj.setAttribute("src",imageList[c]);for(var l=0;l<imageList.length;l++){sImgBox[l].className="self-imgbox"}h.scrollTop=h.scrollTop-174;sImgBox[c].className="self-imgbox selected";return c}if(m.wheelDelta<0){c=c+1;if(c>=imageList.length){c=imageList.length-1}imgObj.setAttribute("src",imageList[c]);for(var j=0;j<imageList.length;j++){sImgBox[j].className="self-imgbox"}h.scrollTop=h.scrollTop+174;sImgBox[c].className="self-imgbox selected";return c}}else{if(m.detail){if(m.detail<0){c=c-1;if(c<0){c=0}for(l=0;l<imageList.length;l++){sImgBox[l].className="self-imgbox"}h.scrollTop=h.scrollTop-174;sImgBox[c].className="self-imgbox selected";imgObj.setAttribute("src",imageList[c]);return c}if(m.detail>0){c=c+1;if(c>=imageList.length){c=imageList.length-1}for(l=0;l<imageList.length;l++){sImgBox[l].className="self-imgbox"}h.scrollTop=h.scrollTop+174;sImgBox[c].className="self-imgbox selected";imgObj.setAttribute("src",imageList[c]);return c}}}})};var pageAutoResize=function(){var i=$id("left-image-box");i.style.height=document.documentElement.clientHeight+"px";var f=$id("right-image-box");f.style.height=document.documentElement.clientHeight+"px";f.style.width=document.documentElement.clientWidth-300+"px";var g=$id("head");var c=$id("right-table");var e=$id("right-image-show");g.style.width=document.documentElement.clientWidth+"px";c.style.height=document.documentElement.clientHeight+"px";c.style.width=document.documentElement.clientWidth-320+"px";if(sys.ie){e.height=document.documentElement.clientHeight*"0.89";e.width=document.documentElement.clientWidth*"0.89"}else{if(sys.firefox||sys.chrome){e.height=document.documentElement.clientHeight*"0.83";e.width=document.documentElement.clientWidth*"0.83"}else{if(sys.safari){e.height=document.documentElement.clientHeight*"0.80";e.width=document.documentElement.clientWidth*"0.80"}}}var h=$id("right-panel");var a=$id("parent-div");a.style.height=f.style.height;h.style.width=document.documentElement.clientWidth-317+"px";h.style.width=document.documentElement.clientWidth-217+"px";h.style.height=(document.documentElement.clientHeight)*imageList.length+"px";var b=$id("popup-background");if(b){b.style.height=document.documentElement.clientHeight+"px";b.style.width=document.documentElement.clientWidth+"px"}var d=$id("popup-image");d.height=document.documentElement.clientHeight;d.width=d.height*8/5};var checkStatus=function(a){if(success(a)){return true}var c="&action=again";var b=window.location.href;if(b.indexOf(c)<0){window.location.href=window.location.href+"&action=again"}return false};var success=function(a){if(a.length==0){return false}return true};function crossDomainAjax(c,a){if("XDomainRequest" in window&&window.XDomainRequest!==null){var b=new XDomainRequest();b.open("get",c);b.onload=function(){var e=new ActiveXObject("Microsoft.XMLDOM"),d=$.parseJSON(b.responseText);e.async=false;if(d==null||typeof(d)=="undefined"){d=$.parseJSON(data.firstChild.textContent)}a(d)};b.onprogress=function(){};b.onerror=function(){_result=false};b.send()}else{if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.match(/MSIE ([\d.]+)/)[1],10)<8){return false}else{$.ajax({url:c,cache:false,dataType:"json",type:"GET",async:false,success:function(d,e){a(d)}})}}}window.onload=function(){var a=$id("content-url").value;crossDomainAjax(a,function(b){imageList=b;if(checkStatus(imageList)){toolBarLoading();showTopBar();leftImageLoading();rightImageLoading();headBarLoading();viewFirstPPT();viewThisPPT();useMouseWheel();pageAutoResize()}})};window.onresize=function(){pageAutoResize()};