var $id=function(a){return document.getElementById(a)};function crossDomainAjax(c,a){if("XDomainRequest" in window&&window.XDomainRequest!==null){var b=new XDomainRequest();b.open("get",c);b.onload=function(){var e=new ActiveXObject("Microsoft.XMLDOM"),d=$.parseJSON(b.responseText);e.async=false;if(d==null||typeof(d)=="undefined"){d=$.parseJSON(data.firstChild.textContent)}a(d)};b.onprogress=function(){};b.onerror=function(){_result=false};b.send()}else{if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.match(/MSIE ([\d.]+)/)[1],10)<8){return false}else{$.ajax({url:c,cache:false,dataType:"json",type:"GET",async:false,success:function(d,e){a(d)}})}}}window.onload=function(){var a=$id("content-url").value;crossDomainAjax(a,function(b){fileList=b;if(checkStatus(fileList)){if(fileList.length>0){preloadingIframe(fileList[0])}}})};var checkStatus=function(a){if(success(a)){return true}var c="&action=again";var b=window.location.href;if(b.indexOf(c)<0){window.location.href=window.location.href+"&action=again"}return false};var success=function(a){if(a.length==0){return false}return true};function preloadingIframe(a){var b=data.type;iframe=document.createElement("iframe");iframe.id="document";iframe.name="document";iframe.scrolling="no";iframe.allowtransparency="true";iframe.height="100%";iframe.width="100%";iframe.src=a;iframe.setAttribute("frameborder","0");if(b=="xls"||b=="xlsx"){$("#canvas").css("width","90%")}else{if(b=="ppt"||b=="pptx"){$("#canvas").css("width","960px")}}$(iframe).load(function(){var c=0;if(document.all){var d=1400}else{var d=220}if(b=="xls"||b=="xlsx"){c=$(this).contents().find("frameset").height()}else{if(b=="ppt"||b=="pptx"){d=0;c=$(this).contents().find("body").height()}else{c=$(this).contents().find("body").height()}}$("#canvas").css("height",c+d);iFrameHeight()});$("#canvas").append(iframe);$(iframe).attr("allowFullScreen","allowFullScreen");$(iframe).attr("webkitallowfullscreen","webkitallowfullscreen");$("#canvas").css("display","block")};