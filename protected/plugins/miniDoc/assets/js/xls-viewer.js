var $id=function(a){return document.getElementById(a)};var getUrl=function(c){var d=c.getAttribute("id");for(var b in sheetItems){var a=sheetItems[b][1];if("sheet"+b==d){return a}}};var showLoadingImage=function(){var c=document.getElementById("gif-url").value;var a=document.getElementsByTagName("body");var e=document.createElement("div");var d=document.createElement("img");e.setAttribute("id","show-loading-image");e.style.width="40px";e.style.height="40px";e.style.position="absolute";e.style.top=document.documentElement.clientHeight/2-50+"px";e.style.left=document.documentElement.clientWidth/2-50+"px";d.src=c;a[0].appendChild(e);e.appendChild(d)};var renderSheet=function(b){for(var a in sheetItems){var c=$id("sheet"+a);c.style.backgroundColor="#dcdcdc"}b.style.backgroundColor="#ffffff";renderSheetGrid(b);selectedItem=b};var renderSheetGrid=function(c){var b=c.getAttribute("showGrid");var a=c.getAttribute("percentage");resetPercentage(a);var d=$id("checkbox-btn");if(b=="1"){d.checked=true}else{d.checked=false}showGrid(c,b,a)};var resetPercentage=function(b){b=parseFloat(b)*100;var a=$id("percentage-bar");a.innerHTML=b+"%";var c=document.styleSheets[0].cssRules||document.styleSheets[0].rules;c[29].style.left=b*0.45+"px"};var showGrid=function(e,b,a){var d=$id("content-box");if(navigator.userAgent.indexOf("MSIE 8.0")>0){d.style.width=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)+60+"px";d.style.height=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight)+60+"px"}else{showLoadingImage();d.style.width=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)+"px";d.style.height=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight)+"px"}var c=getUrl(e);if(b=="1"){c=c+"?showGrid=1"}else{c=c+"?showGrid=0"}c=c+"&percentage="+a;d.setAttribute("src",c)};var renderTitles=function(a){var e=$id("title-bar");var b;for(var d in a){var f=a[d];var h=f[0];var c=f[1];var g=document.createElement("a");g.setAttribute("id","sheet"+d);g.setAttribute("showGrid","0");g.setAttribute("url",c);g.setAttribute("onclick","renderSheet(this)");g.setAttribute("percentage","1");g.setAttribute("class","title-bar-style");g.setAttribute("className","title-bar-style");g.innerHTML=h;e.appendChild(g);if(h.length>11){g.style.width=200+"px"}else{g.style.width=h.length*18+"px"}if(d==0){b=g}}if(a.length>0){renderSheet(b)}};$id("checkbox-btn").onclick=function(){refreshSheet()};$id("content-box").onload=function(){var a=$id("content-box");a.setAttribute("class","iframe-page");a.setAttribute("className","iframe-page");a.setAttribute("frameborder","0");a.setAttribute("scrolling","no");a.setAttribute("style","display");a.setAttribute("style","width");a.setAttribute("style","height");a.style.width=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)+"px";a.style.height=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight)+"px";a.style.display="block";document.getElementsByTagName("body")[0].removeChild(document.getElementById("show-loading-image"))};var refreshSheet=function(){var b=$id("checkbox-btn").checked?"1":"0";selectedItem.setAttribute("showGrid",b);var a=selectedItem.getAttribute("percentage");showGrid(selectedItem,b,a)};var getZoomPos=function(){var b=document.styleSheets[0].cssRules||document.styleSheets[0].rules;var a=parseInt(b[29].style.left);return a};var setZoomPos=function(a){var b=document.styleSheets[0].cssRules||document.styleSheets[0].rules;b[29].style.left=a*0.45+"px";selectedItem.setAttribute("percentage",a/100);refreshSheet()};$id("first-page").onclick=function(){renderSheet($id("sheet0"))};$id("previous-page").onclick=function(){var a=selectedItem.id;for(var b in sheetItems){if("sheet"+b==a){var c=b-1;if(c<0){c=0}renderSheet($id("sheet"+c))}}};$id("next-page").onclick=function(){var a=selectedItem.id;var c=sheetItems.length;for(var b in sheetItems){if("sheet"+b==a){var d=parseInt(b)+1;if(d>c-1){d=c-1}renderSheet($id("sheet"+d))}}};$id("last-page").onclick=function(){renderSheet($id("sheet"+(sheetItems.length-1)))};$id("reduce-btn").onclick=function(){var a=$id("percentage-bar");var c=getZoomPos();c=c-9;if(c<=0){c=0}var b=c/45*100;setZoomPos(b);a.innerHTML=b+"%"};$id("amplify-btn").onclick=function(){var a=$id("percentage-bar");var c=getZoomPos();c=c+9;if(c>=90){c=90}var b=c/45*100;setZoomPos(b);a.innerHTML=b+"%"};var adaptionBrowserSize=function(){var a=$id("main-box");a.style.height=document.documentElement.clientHeight-20+"px"};var checkStatus=function(a){if(success(a)){return true}var c="&action=again";var b=window.location.href;if(b.indexOf(c)<0){window.location.href=window.location.href+"&action=again"}return false};var success=function(a){if(a.length==0){return false}return true};function crossDomainAjax(c,a){if("XDomainRequest" in window&&window.XDomainRequest!==null){var b=new XDomainRequest();b.open("get",c);b.onload=function(){var e=new ActiveXObject("Microsoft.XMLDOM"),d=$.parseJSON(b.responseText);e.async=false;if(d==null||typeof(d)=="undefined"){d=$.parseJSON(data.firstChild.textContent)}a(d)};b.onprogress=function(){};b.onerror=function(){_result=false};b.send()}else{if(navigator.userAgent.indexOf("MSIE")!=-1&&parseInt(navigator.userAgent.match(/MSIE ([\d.]+)/)[1],10)<8){return false}else{$.ajax({url:c,cache:false,dataType:"json",type:"GET",async:false,success:function(d,e){a(d)}})}}}window.onload=function(){var a=$id("content-url").value;crossDomainAjax(a,function(b){sheetItems=b;selectedItem="";if(checkStatus(sheetItems)){adaptionBrowserSize();renderTitles(sheetItems)}})};window.onresize=function(){adaptionBrowserSize()};